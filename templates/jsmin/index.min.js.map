{"version":3,"sources":["js/index.js"],"names":["delayTimeout","model","debug","origin","document","location","templatesCache","logined","this","_loginedUser","loginedUser","v","getElementById","innerText","username","refreshApp","_selfRegAllowed","selfRegAllowed","showElements","hideElements","_captchaRequired","captchaRequired","_authRoles","authRoles","isAdmin","renderPage","some","e","rolename","_user","user","_app","app","_users","users","_apps","apps","all_app_options","all_user_options","_allApps","allApps","createOptions","querySelector","innerHTML","_allUsers","allUsers","_app_user_roles","app_user_roles","selectValues","keyProp","textProp1","textProp2","output","forEach","value","push","join","highlightTab","tabid","removeClass","addClass","split","showPage","pageid","dontpush","a","pageid0","id","text","focus","history","state","pushState","getApp","getUser","renderTemplateFile","templateFile","data","targetSelector","renderTemplate","template","rendered","Mustache","render","cachedTemlpate","console","info","fetch","then","x","t","elemSelector","alertOnError","msg","alert","getCookie","cname","name","ca","decodeURIComponent","cookie","i","length","c","charAt","substring","indexOf","delayFunc","f","delay","clearTimeout","setTimeout","searchApps","checked","searchAppsInModel","formListAppSubmit","trim","replace","r","RegExp","found","filter","s","Object","values","test","sortAppsBy","prop","sort","b","appname","searchUsers","searchUsersInModel","formListUserSubmit","sortUsersBy","doGraphQLRequest","query","responseHandler","errorElementID","method","credentials","body","JSON","stringify","variables","res","ok","json","Error","log","errors","message","catch","error","loginGraphQLFormSubmit","event","preventDefault","getLoginedUser","clearLoginForm","logoutGraphQLFormSubmit","isSelfRegAllowed","is_selfreg_allowed","isCaptchaRequired","is_captcha_required","getNewCaptcha","generateNewPassword","generate_password","get_logined_user","getAuthRoles","list_app_user_role","list_user","list","formUserSubmit","userOperationName","password","email","fullname","description","disabled","refreshData","get_user","groupApps","gr","aur","arr","key","entries","rec","app_description","items","deleteUser","list_app","formAppSubmit","appOperationName","url","rebase","public","get_app","groupUsers","user_fullname","deleteApp","getAllApps","getAllUsers","formListRoleSubmit","modifyRole","action","onsuccess","refreshRoles","allUsersValue","ui","allAppsValue","ai","filterRows","selector","toLowerCase","querySelectorAll","classList","add","remove","classname","hidePassword","setAttribute","showPassword","generatePassword","n","pickSymbol","Math","floor","random","symbolSets","newPassword","uri","Date","getTime","src","logout","k","keys","startsWith","getLandingPageid","p","hash","slice","params","window","onhashchange","newpage","newURL"],"mappings":"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","sourcesContent":["// M O D E L  ******************************************************************************************\n\nvar model = {\n    // if debug == true logs go to console.\n    debug: true,\n    origin: document.location.origin, //'http://127.0.0.1:4400',//\n\n    // templatesCache keeps loaded templates, not to load them repeatedly\n    templatesCache =[],\n\n\n    get logined(){\n         return (this._loginedUser != null)\n    },\n \n    //---------------------------\n    _loginedUser: null,\n    set loginedUser(v) {\n        this._loginedUser = v\n        if (v) {\n            document.getElementById(\"userTab\").innerText = v.username\n            // getAuthRoles(model.loginedUser.username)\n        } else {\n            document.getElementById(\"userTab\").innerText = \"\"\n        }\n        refreshApp()\n        \n    },\n    get loginedUser() {\n        return this._loginedUser\n    },\n\n    //---------------------------\n    _selfRegAllowed: false,\n    set selfRegAllowed(v) {\n        this._selfRegAllowed = v\n        if (v) {\n            showElements(\"#selfRegButton\")\n        } else {\n            hideElements(\"#selfRegButton\")\n        }\n    },\n    get selfRegAllowed() {\n        return this._selfRegAllowed\n    },\n    \n    //---------------------------\n    _captchaRequired: false,\n    set captchaRequired(v) {\n        this._captchaRequired = v\n        if (v) {\n            showElements(\"#captcha\")\n        } else {\n            hideElements(\"#captcha\")\n        }\n    },\n    get captchaRequired() {\n        return this._captchaRequired\n    },\n\n    //---------------------------\n    _authRoles: null,\n    set authRoles(v) {\n        this._authRoles = v\n        if (this.isAdmin){\n            showElements('#usersTab')\n            showElements('#rolesTab')\n            showElements('#graphqlTest')\n            showElements('#btnNewApp')\n        } else {\n            hideElements('#usersTab')\n            hideElements('#rolesTab')\n            hideElements('#graphqlTest')\n            hideElements('#btnNewApp')\n\n            // showPage('apps')\n        }\n        renderPage('apps','.app-search-results')\n        \n    },\n    get authRoles() {\n        return this._authRoles\n    },\n    get isAdmin() {\n        if (!model.authRoles) return false\n        return model.authRoles.some(e => e.rolename == \"authadmin\")\n    },\n    \n    //---------------------------\n    _user: null,\n    set user(v) {\n        this._user = v\n        renderPage('user','#userPage')\n    },\n    get user() {\n        return this._user\n    },\n    \n    //---------------------------\n    _app: null,\n    set app(v) {\n        this._app = v\n        renderPage('app','#appPage')\n    },\n    get app() {\n        return this._app\n    },\n    \n    //---------------------------\n    _users: null,\n    set users(v) {\n        this._users = v\n        renderPage('users','.user-search-results')\n    },\n    get users() {\n        return this._users\n    },\n    \n    //---------------------------\n    _apps: null,\n    set apps(v) {\n        this._apps = v\n        renderPage('apps','.app-search-results')\n    },\n    get apps() {\n        return this._apps\n    },\n\n    //---------------------------\n    all_app_options: null,\n    all_user_options:null,\n    //---------------------------\n    _allApps: null,\n    set allApps(v) {\n        this._allApps = v\n        this.all_app_options = createOptions(v, \"appname\", \"description\", \"url\")\n        document.querySelector(\"#allAppsDataList\").innerHTML = this.all_app_options\n    },\n    get allApps() {\n        return this._allApps\n    },\n\n    //---------------------------\n    _allUsers: null,\n    set allUsers(v) {\n        this._allUsers = v\n        this.all_user_options = createOptions(v, \"username\", \"fullname\", \"email\")\n        document.querySelector(\"#allUsersDataList\").innerHTML = this.all_user_options\n    },\n    get allUsers() {\n        return this._allUsers\n    },\n    \n    //---------------------------\n    _app_user_roles: null,\n    set app_user_roles(v) {\n        this._app_user_roles = v\n        renderPage('roles','.app-user-roles-results')\n    },\n    get app_user_roles() {\n        return this._app_user_roles\n    },\n\n    \n}\n\n\n\n// F U N C T I O N S  *********************************************************************************\n\nfunction createOptions(selectValues, keyProp, textProp1, textProp2) {\n    var output = []\n    selectValues && selectValues.forEach(function(value)\n    {\n      output.push(`<option value=\"${value[keyProp]}\">${value[textProp1]} &nbsp;&nbsp;&nbsp; ${value[textProp2]?value[textProp2]:''}</option>`);\n    })\n    let optionText = output.join('')\n    return optionText\n}\n\n\nfunction highlightTab(tabid) {\n    removeClass('.tab', \"underlined\")\n    var tabid0 = tabid.split(\"/\")[0]\n    addClass('#'+tabid0+'Tab', \"underlined\")   \n}\n\n\nfunction showPage(pageid, dontpush){\n    //распарсить pageidExtended\n    var a = pageid.split(\"/\")\n    var pageid0 = a[0]\n    var id = a[1]\n\n    highlightTab(pageid)\n    \n    hideElements('.page')\n    showElements('#'+pageid0+'Page')\n\n\n    // setting focus\n    var text = document.querySelector('#'+pageid0+'Page input[type=\"text\"]')\n    if(text) \n        text.focus()\n\n\n    if (!dontpush){\n        if (!history.state || history.state.pageid != pageid ){\n            history.pushState({pageid:pageid},pageid, \"#\"+pageid) \n        }\n    }\n\n    if (id) {\n        if (pageid0 == \"app\"){\n            getApp(id)\n        } \n        if (pageid0 == \"user\"){\n            getUser(id)\n        }\n    }\n\n\n    return false\n}\n\n\nfunction renderTemplateFile(templateFile, data, targetSelector) {\n\n    function renderTemplate(template) {\n        var rendered = Mustache.render(template, data)\n        document.querySelector(targetSelector).innerHTML = rendered\n    }    \n\n    var cachedTemlpate = model.templatesCache[templateFile]\n    \n    if (cachedTemlpate) {\n        renderTemplate(cachedTemlpate) \n        console.info(\"from cache:\",templateFile)\n        return\n    }\n    \n    // $.get(templateFile, onSuccess);\n    fetch(templateFile).then(x => x.text()).then( t => {\n        model.templatesCache[templateFile]=t \n        renderTemplate(t)\n    })\n}\n\n\nfunction renderPage(pageid, elemSelector) {\n    renderTemplateFile('mustache/'+pageid+'.html', model, elemSelector)\n}\n\n\nfunction alertOnError(e, msg){\n    alert(msg, e)\n}\n\n\nfunction getCookie(cname) {\n    var name = cname + \"=\";\n    var decodedCookie = decodeURIComponent(document.cookie);\n    var ca = decodedCookie.split(';');\n    for(var i = 0; i <ca.length; i++) {\n      var c = ca[i];\n      while (c.charAt(0) == ' ') {\n        c = c.substring(1);\n      }\n      if (c.indexOf(name) == 0) {\n        return c.substring(name.length, c.length);\n      }\n    }\n    return \"\";\n}\n\n\nvar delayTimeout\nfunction delayFunc(f, delay=500) {\n   clearTimeout(delayTimeout) \n   delayTimeout = setTimeout(f, delay)  \n   return false \n}\n\n\nfunction searchApps() {\n    if (document.querySelector('#chkLocalSearch').checked) {\n        return delayFunc(searchAppsInModel, 100)\n    } else {\n        return delayFunc(formListAppSubmit)\n    }\n}\n\nfunction searchAppsInModel() {\n    if (!model.allApps) return\n    var text = document.querySelector(\"#formListApp input[name='search']\").value.trim().replace(' ','.*')\n    var r = new RegExp(text, 'i')\n    let found = model.allApps.filter((v)=>{\n        var s = Object.values(v).join(' ')\n        return r.test(s)\n    })\n    model.apps = found\n    return false   \n}\n\n\nfunction sortAppsBy(prop) {\n    if (!model._allApps) return false\n    model._allApps.sort( (a,b) => (a[prop]+a.appname)>(b[prop]+b.appname)? 1: -1)\n    model._apps.sort( (a,b) => (a[prop]+a.appname)>(b[prop]+b.appname)? 1: -1 )\n    model.apps = model._apps\n    return false\n}\n\n\nfunction searchUsers() {\n    if (document.querySelector('#chkLocalSearch').checked) {\n        return delayFunc(searchUsersInModel, 100)\n    } else {\n        return delayFunc(formListUserSubmit)\n    }\n}\n\n\nfunction searchUsersInModel() {\n    if (!model.allUsers) return\n    var text = document.querySelector(\"#formListUser input[name='search']\").value.trim().replace(' ','.*')\n    var r = new RegExp(text, 'i')\n    let found = model.allUsers.filter( (v) => r.test (Object.values(v).join(' ')) )\n    model.users = found\n    return false   \n}\n\n\nfunction sortUsersBy(prop) {\n    if (!model._allUsers) return false\n    model._allUsers.sort( (a,b) => (a[prop]+a.username)>(b[prop]+b.username)? 1: -1)\n    model._users.sort( (a,b) => (a[prop]+a.username)>(b[prop]+b.username)? 1: -1 )\n    model.users = model._users\n    return false\n}\n\n\n\n// R E Q U E S T S  *******************************************************\n\nfunction doGraphQLRequest(query, responseHandler, errorElementID) {\n    // $.ajax({ url: \"/graphql\", type: \"POST\", data: { query: query }, error: alertOnError, \n    //     success: (res) => {\n    //         model.debug && console.log(res)\n    //         if (res.errors){\n    //             model.debug && console.log(res.errors[0].message)\n    //             if (errorElementID) {\n    //                 document.getElementById(errorElementID).innerText = res.errors[0].message\n    //             }\n    //             return\n    //         }\n    //         responseHandler(res)\n    //     } \n    // })\n\n    fetch(model.origin+'/graphql', { \n        method: 'POST', \n        credentials: 'include', \n        body: JSON.stringify({ query: query, variables: {} }) \n    })\n        .then(res => { \n          if (res.ok) return res.json();\n          new Error(res)\n        })\n        .then((res) => {\n            model.debug && console.log(res)\n            if (res.errors){\n                model.debug && console.log(res.errors[0].message)\n                if (errorElementID) {\n                    document.getElementById(errorElementID).innerText = res.errors[0].message\n                }\n                return\n            }\n            responseHandler(res)\n        })\n        .catch(console.error)    \n    \n}\n\n\n// L O G I N  *****************************************************************************\n\nfunction loginGraphQLFormSubmit(event) {\n    if (event) event.preventDefault()\n    \n    let username = document.getElementById(\"loginUsername\").value\n    let password = document.getElementById(\"loginPassword\").value\n    let captcha =  document.getElementById(\"loginCaptcha\").value\n    \n    \n\n    let query =`\n    query {\n        login(\n        username: \"${username}\",\n        password: \"${password}\",\n        captcha: \"${captcha}\"\n        )\n        }    \n    `\n    function onSuccess(res){\n        getLoginedUser()\n    }   \n\n    doGraphQLRequest(query, onSuccess, \"loginError\")\n    clearLoginForm()\n    return false       \n}\n\n\n\nfunction logoutGraphQLFormSubmit(event) {\n    if (event) event.preventDefault()\n    var query =`\n    query {\n        logout {\n            message\n            username\n          }\n        }\n    `\n\n    function onSuccess(res){\n        model.loginedUser = null\n        refreshApp()\n    }\n\n    doGraphQLRequest(query, onSuccess)\n    return false       \n}\n\n\n\nfunction isSelfRegAllowed(event) {\n    if (event) event.preventDefault()\n    var query =` query { is_selfreg_allowed }`\n\n    function onSuccess(res){\n        model.selfRegAllowed = res.data.is_selfreg_allowed\n    }\n       \n    doGraphQLRequest(query, onSuccess)\n    return false       \n}\n\nfunction isCaptchaRequired(event) {\n    if (event) event.preventDefault()\n    let username = document.getElementById(\"loginUsername\").value   \n    var query =`  query { is_captcha_required(  username: \"${username}\" ) } `\n\n    function onSuccess(res){\n        model.captchaRequired = res.data.is_captcha_required\n        if (model.captchaRequired) {\n            getNewCaptcha()\n            model.debug && console.log(\"Captcha IS required\")\n        }\n    }\n       \n    doGraphQLRequest(query, onSuccess)\n    return false       \n}\n\n\n\nfunction generateNewPassword(event) {\n    if (event) event.preventDefault()\n\n    let username = document.getElementById(\"loginUsername\").value\n\n    var query =`\n    mutation {\n        generate_password(\n        username: \"${username}\"\n        ) \n        }\n    `\n    function onSuccess(res){\n        alert(res.data.generate_password)\n        refreshApp()\n    }   \n\n    doGraphQLRequest(query, onSuccess)\n    return false       \n}\n\n\n\n// L O G I N E D   U S E R   **********************************************************************************************************************\n\n\nfunction getLoginedUser() {\n    model.loginedUser = null\n    \n    var query =`\n    query {\n        get_logined_user {\n            description\n            email\n            fullname\n            username\n            disabled\n        }\n    }\n    `\n    \n    function onSuccess(res){\n        model.loginedUser = res.data.get_logined_user\n        getAuthRoles(model.loginedUser.username)\n        getUser(model.loginedUser.username)\n    } \n    \n    doGraphQLRequest(query, onSuccess)\n    return false       \n}\n\nfunction getAuthRoles(username) {\n    model.authRoles = null\n\n    var query =`\n    query {\n        list_app_user_role(\n            appname: \"auth\",\n            username: \"${username}\"\n            ) {\n                rolename\n            }\n        }\n        `\n\n    function onSuccess(res){\n        model.authRoles = res.data.list_app_user_role\n    } \n\n    doGraphQLRequest(query, onSuccess)\n    return false       \n}\n\n\n// U S E R S  ***********************************************************************************************************************\n\n\nfunction formListUserSubmit(event) {\n    if (event) event.preventDefault()\n    model.users = null\n    let search = document.querySelector(\"#formListUser input[name='search']\").value\n    \n    var query =`\n    query {\n        list_user(\n        search: \"${search}\",\n        order: \"fullname ASC\"\n        ) {\n            length\n            list {\n              description\n              email\n              fullname\n              username\n              disabled\n            }\n          }\n        }        \n    `\n    \n    function onSuccess(res){\n        model.users = res.data.list_user.list\n    } \n\n    doGraphQLRequest(query, onSuccess)\n    return false       \n}\n\n\n\nfunction formUserSubmit(event, userOperationName = 'create_user') {\n    if (event) event.preventDefault()\n    let username =      document.querySelector(\"#formUser input[name='username']\").value\n    let password =      document.querySelector(\"#formUser input[name='password']\").value\n    let email    =      document.querySelector(\"#formUser input[name='email']\").value\n    let fullname =      document.querySelector(\"#formUser input[name='fullname']\").value\n    let description =   document.querySelector(\"#formUser *[name='description']\").value\n    let disabled =      document.querySelector(\"#formUser input[name='disabled']\").value\n    \n    var query =`\n    mutation {\n        ${userOperationName}(\n        username: \"${username}\",\n        password: \"${password}\",\n        email: \"${email}\",\n        fullname: \"${fullname}\",\n        description: \"${description}\",\n        disabled: ${disabled}\n        ) {\n            description\n            email\n            fullname\n            username\n            disabled\n          }\n\n        }\n    `\n\n    function onSuccess(res){\n        alert(userOperationName+\" success\")\n        refreshData()\n        model.user = res.data[userOperationName]\n        if (userOperationName == 'create_user' && !model.logined) {\n            alert(`\"${username}\" is created.` )\n            showPage('login',true)\n        }\n        getUser(username)\n    }\n\n    doGraphQLRequest(query, onSuccess)\n    return false       \n}\n\n\n\nfunction getUser(username) {\n    model.user = null\n    var query =`\n    query {\n        get_user(\n        username: \"${username}\"\n        ) {\n            description\n            email\n            fullname\n            username\n            disabled\n          }\n        \n        list_app_user_role(\n        username: \"${username}\"\n        ) {\n            app_description\n            appname\n            rolename\n            username\n          }\n        \n        }\n\n    `\n\n    function onSuccess(res){\n        model.user = res.data.get_user\n        model.user.apps = groupApps(res.data.list_app_user_role)\n    } \n\n    doGraphQLRequest(query, onSuccess)\n    return false       \n}\n\n\nfunction groupApps(list_app_user_role) {\n    if (!list_app_user_role) return []\n    \n    let gr = {}\n    for (let aur of list_app_user_role ){\n        if (!gr[aur.appname]) gr[aur.appname] =[]\n        gr[aur.appname].push(aur)\n    }\n\n    let arr = []\n\n    for (let [key, value] of Object.entries(gr)) {\n        let rec = {}\n        rec.appname =key\n        rec.app_description = value[0].app_description\n        rec.items = value\n        arr.push(rec)\n    }\n    return arr\n}\n\n\n\nfunction deleteUser(username) {\n    var query =`\n    mutation {\n        delete_user(\n        username: \"${username}\"\n        ) {\n            username\n          }\n        }\n    `\n    function onSuccess(res){\n        model.user = null\n        refreshData()\n        showPage('users')\n    } \n\n    doGraphQLRequest(query, onSuccess)\n    return false       \n}\n\n\n// A P P S  *******************************************************************\n\nfunction formListAppSubmit(event) {\n    if (event) event.preventDefault()\n    model.apps = null\n    let search = document.querySelector(\"#formListApp input[name='search']\").value\n    var query =`\n    query {\n        list_app(\n        search: \"${search}\",\n        order: \"description ASC\"\n        ) {\n            length\n            list {\n              appname\n              description\n              url\n              rebase\n              public\n            }\n          }\n        }    `\n\n    function onSuccess(res){\n        model.apps = res.data.list_app.list\n    } \n\n    doGraphQLRequest(query, onSuccess)\n    return false       \n}\n\n\n\nfunction formAppSubmit(event, appOperationName = 'create_app') {\n    if (event) event.preventDefault()\n    model.app = null\n    let appname =     document.querySelector(\"#formApp input[name='appname']\"    ).value\n    let url =         document.querySelector(\"#formApp input[name='url']\"        ).value\n    let description = document.querySelector(\"#formApp input[name='description']\").value\n    let rebase =      document.querySelector(\"#formApp input[name='rebase']\"     ).value\n    let public =      document.querySelector(\"#formApp input[name='public']\"     ).value\n    \n    var query =`\n    mutation {\n        ${appOperationName}(\n        appname: \"${appname}\",\n        url: \"${url}\",\n        description: \"${description}\",\n        rebase: \"${rebase}\",\n        public: \"${public}\"\n        ) {\n            description\n            appname\n            url\n            rebase\n            public\n          }\n\n        }\n    `\n    function onSuccess(res){\n        alert(appOperationName+\" success\")\n        model.app = res.data[appOperationName]\n        refreshData()\n        getApp(appname)\n    } \n\n    doGraphQLRequest(query, onSuccess)\n    return false       \n}\n\n\n\nfunction getApp(appname) {\n    model.app = null\n\n    var query =`\n    query {\n        get_app(\n        appname: \"${appname}\"\n        ) {\n            description\n            appname\n            url\n            rebase\n            public\n          }\n        \n        list_app_user_role(\n        appname: \"${appname}\"\n        ) {\n            appname\n            rolename\n            user_fullname\n            user_disabled\n            username\n          }\n        \n        }\n\n    `\n\n    function onSuccess(res){\n        model.app = res.data.get_app\n        model.app.users = groupUsers(res.data.list_app_user_role)\n    } \n\n    doGraphQLRequest(query, onSuccess)\n    return false       \n}\n\n\nfunction groupUsers(list_app_user_role) {\n    let gr = {}\n    for (let aur of list_app_user_role ){\n        if (!gr[aur.username]) gr[aur.username] =[]\n        gr[aur.username].push(aur)\n    }\n\n    let arr = []\n\n    for (let [key, value] of Object.entries(gr)) {\n        let rec = {}\n        rec.username =key\n        rec.user_fullname = value[0].user_fullname\n        rec.items = value\n        arr.push(rec)\n    }\n    return arr\n}\n\n\n\nfunction deleteApp(appname) {\n    var query =`\n    mutation {\n        delete_app(\n        appname: \"${appname}\"\n        ) {\n            appname\n          }\n        }\n    `\n    function onSuccess(res){\n        model.app = null\n        refreshData()\n        showPage('apps') ;\n    } \n\n    doGraphQLRequest(query, onSuccess)\n    return false       \n}\n\n\n\n\n// A P P   U S E R   R O L E   **************************************************************************************************\n\nfunction getAllApps(event) {\n    if (event) event.preventDefault()\n    model.allApps = null\n    var query =`\n    query {\n        list_app(\n        order: \"appname ASC\"\n        ) {\n            length\n            list {\n              appname\n              description\n              url\n              rebase\n              public \n            }\n          }\n        }    `\n\n    function onSuccess(res){\n        model.allApps = res.data.list_app.list\n    } \n\n    doGraphQLRequest(query, onSuccess)\n    return false       \n}\n\n\nfunction getAllUsers(event) {\n    if (event) event.preventDefault()\n    model.allUsers = null\n    var query =`\n    query {\n        list_user(\n        order: \"fullname ASC\"\n        ) {\n            length\n            list {\n              username\n              fullname\n              email\n              description\n              disabled\n            }\n          }\n        }    `\n\n    function onSuccess(res){\n        model.allUsers = res.data.list_user.list\n    } \n\n    doGraphQLRequest(query, onSuccess)\n    return false       \n}\n\nfunction formListRoleSubmit(event) {\n    if (event && event.preventDefault ) event.preventDefault()\n    model.app_user_roles = null\n    let appname =  document.getElementById(\"allApps\").value\n    let username = document.getElementById(\"allUsers\").value\n    if (!appname || !username) \n        return\n\n    var query =`\n    query {\n        list_app_user_role(\n        appname: \"${appname}\",\n        username: \"${username}\"\n        ) {\n            rolename\n          }\n        }        \n        `\n\n    function onSuccess(res){\n        model.app_user_roles = res.data.list_app_user_role\n    } \n\n    doGraphQLRequest(query, onSuccess)\n    return false       \n}\n\n\nfunction modifyRole(action,appname,username,rolename, onsuccess ) {\n    if (!appname || !username || !rolename) return\n\n    var query =`\n    mutation {\n        ${action}_app_user_role(\n        appname: \"${appname}\",\n        username: \"${username}\",\n        rolename: \"${rolename}\"\n        ) {\n            rolename\n            appname\n            username\n          }\n        }\n    `\n    function onSuccess(res){\n        if (onsuccess) onsuccess()\n    }\n\n    doGraphQLRequest(query, onSuccess)\n    return false       \n}\n\n// works when input values on roles page change\nfunction refreshRoles() {\n    let allUsersValue = document.getElementById(\"allUsers\").value\n    if (allUsersValue) {\n        let ui = document.querySelector(`#allUsersDataList>option[value='${allUsersValue}']`).innerText\n        document.getElementById('userInfo').innerText = ui   \n    }\n\n    let allAppsValue = document.getElementById(\"allApps\").value\n    if (allAppsValue) {\n        let ai = document.querySelector(`#allAppsDataList>option[value='${allAppsValue}']`).innerText\n        document.getElementById('appInfo').innerText = ai\n    }\n\n    if (allUsersValue && allAppsValue) \n        formListRoleSubmit() \n}\n\n\nfunction filterRows(selector, value ){\n    var v = value.toLowerCase()\n    var rows = document.querySelectorAll(selector)\n    rows.forEach(e => {\n        var txt = e.innerText.toLowerCase()\n        if (txt.indexOf(v) == -1) {\n            e.classList.add(\"hidden\")\n        } else {\n            e.classList.remove(\"hidden\")\n        }\n    });\n}\n\nfunction hideElements(selector) {\n    document.querySelectorAll(selector).forEach(e => e.classList.add(\"hidden\"));\n}\n\n\nfunction showElements(selector) {\n    document.querySelectorAll(selector).forEach(e => e.classList.remove(\"hidden\"));\n}\n\nfunction addClass(selector, classname) {\n    document.querySelectorAll(selector).forEach(e => e.classList.add(classname));\n}\n\nfunction removeClass(selector, classname) {\n    document.querySelectorAll(selector).forEach(e => e.classList.remove(classname));\n}\n\n\nfunction hidePassword() {\n    document.querySelector(\"#formUser input[name='password']\").setAttribute('type','password')\n}\n\nfunction showPassword() {\n    document.querySelector(\"#formUser input[name='password']\").setAttribute('type','text')\n}\n\nfunction generatePassword() {\n    function newPassword (n) {\n        let pickSymbol =(s) => s[Math.floor(Math.random()*s.length)]\n        var symbolSets =[\"bcdfghjklmnpqrstvwxz\",\"aeiou\"] \n        var password = ''\n        for (let i=0; i<n; i++){\n            password += pickSymbol(symbolSets[i%symbolSets.length])\n        }\n        return password\n    }\n\n    document.querySelector(\"#formUser input[name='password']\").value = newPassword(9)\n}\n\n\nfunction getNewCaptcha(event) {\n    let uri = model.origin+\"/captcha?\"+ new Date().getTime()\n    document.getElementById(\"captchaImg\").src = uri\n    return false\n}\n\n\nfunction clearLoginForm() {\n    document.getElementById(\"loginUsername\").value = \"\"\n    document.getElementById(\"loginPassword\").value = \"\"\n    document.getElementById(\"loginCaptcha\").value = \"\"\n    document.getElementById(\"loginError\").innerText = \"\"\n}\n\n\nfunction logout() {\n    logoutGraphQLFormSubmit()\n    clearLoginForm()\n    showPage('login',true)\n    isSelfRegAllowed()\n    model.captchaRequired = false\n    // isCaptchaRequired()\n    return false\n}\n\n\n// O N   P A G E   L O A D  ****************************************************************************************\n\nfunction refreshData() {\n    if (model.logined) {\n        // getLoginedUser()\n        getAllApps()\n        getAllUsers()\n        formListAppSubmit()\n        formListUserSubmit()  \n    } else {\n        // nullify model's inner props\n        for (const k of Object.keys(model)) {\n            if (k.startsWith('_')) {\n                model[k] = null\n                // console.log(`model.${k} = null`)\n            }\n        }\n        isSelfRegAllowed()\n   }    \n}\n\nfunction getLandingPageid(){\n    var p = location.hash.slice(1)\n    return p ? p : 'apps'\n}\n\nfunction refreshApp(params) {\n    refreshData()\n\n    if (model.logined) {\n        let page = getLandingPageid()\n        showPage(page) \n        showElements('#menu')     \n    } else {\n        showPage('login',true)\n        hideElements('#menu')\n    }  \n}\n\n\n\nwindow.onhashchange = function(event) {\n    console.log(\"onhashchange\", event)\n    var newpage = event.newURL.split('#')[1]\n    if (newpage) \n        showPage(newpage)\n}\n\n// window.onpopstate = function(event) {\n//     console.log( \"event.state: \" + JSON.stringify(event.state));\n// }\n\n\nmodel.captchaRequired = false\ngetLoginedUser()\nrefreshApp()"]}